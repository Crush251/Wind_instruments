# 灵巧手 + 黑臂 快速部署与操作指南（README）

> 适用对象：**新机器首次部署** 或 **已部署后的日常使用**。  
> 网络前提：目标设备与主控机处于同一网段（如 `192.168.1.xxx`）。

---

## 一、开始（单机调试）

### 1）SSH 登录并进入工作目录
```bash
ssh linkerhand@192.168.1.xx
cd ~/pi   # 进入 pi 文件夹（若路径不同，请进入实际的 pi 目录）
```

### 2）启动 4 个 CAN（检查蓝灯）
```bash
./startcan.sh
```
- 观察 **蓝灯是否常亮**：长亮表示启动成功。


### 3）生成配置文件
```bash
./createconfigarmv7
```
- 该步骤会生成系统运行所需的配置文件。

### 4）进入调试页面，调试手臂 up/down 序列并合并
```bash
./blackarm_serverarmv7
```
#### 进入浏览器输入以下地址进入调试
```bash
192.168.1.xx:8080
```
- 在调试页面中：
  - 调试 **手臂 up** 与 **down** 的动作序列；
  - **注意最后合并** 动作序列，并**严格按以下名称**保存：
    - `hlsup`
    - `hlsdown`
  - 手指按压程度请**选择乐器：`sn`（唢呐）**进行调整与保存。

### 5）启动演奏页面，验证能否正常出声
```bash
./sksarm7
```
#### 进入浏览器输入以下地址进入调试
```bash
192.168.1.xx:8088
```
- 在演奏页面点击“演奏”，查看**手臂与手指按压**是否**能正确出声**。  
- **提示**：如遇“找不到命令”，请尝试：
```bash
  ./sksarmv7
```

---

## 二、一键控制（多机批量）

完成上面的单机步骤后，可通过服务器为**多台设备**下发统一指令：
```bash
python3 server.py
```
### 正确启动后，会看到 192.168.1.xx已连接，交换机上接了多少个树梅派就会显示几个已连接
### 数字命令含义
- `1`：启动 4 个 CAN（观察蓝灯是否**常亮**，常亮为成功）  
- `2`：执行 `./createconfigarmv7`，生成配置文件  
- `3`：**启动第三步保存的 `hlsup` 序列**  
- `4`：**启动第三步保存的 `hlsdown` 序列**  
- `5`：停止播放  
- `6`：计算**青花瓷**的播放序列 （bpm108 吐音间隔30ms）
- `7`：播放**青花瓷**  （bpm108 吐音间隔30ms）
- `8`：计算**青花瓷**的播放序列 （bpm108 吐音间隔20ms）
- `9`：播放**青花瓷**  （bpm108 吐音间隔20ms）
- **提示**：先输入2或3进行测试。青花瓷有大概20s的空拍，20s以后才会演奏
> 建议：确保各目标机器已按**单机流程**正确完成（CAN、配置、序列合并与命名），再进行批量控制。

---

## 三、快速排障清单

- **CAN 未启动 / 蓝灯不亮**
  - 重复执行 `./startcan.sh`；
  - 检查硬件连接与电源；
  - 必要时重启设备。

- **找不到命令或无执行权限**
  - 确认当前目录为 `pi` 目录；
  - 给予可执行权限：`chmod +x *.sh` 或针对单个文件赋权；
  - `./sksarm7` 如报错，可尝试 `./sksarmv7`。

- **演奏无声或手指力度异常**
  - 在调试页面确认已选择 **`sn`（唢呐）** 并正确保存；
  - 检查合并后的序列文件名是否 **严格为** `hlsup`、`hlsdown`；
  - 重新执行生成配置（`./createconfigarmv7`）并重试。

- **批量下发无响应**
  - 确认主控机与目标设备处于同一网段（如 `192.168.1.xxx`）；
  - 确认各目标设备已完成单机步骤；
  - 检查 `server.py` 运行状态与网络连通性（ping 目标 IP）。

---

## 四、常用命令速查

```bash
# 登录与进入目录
ssh linkerhand@192.168.1.xx
cd ~/pi

# 启动 4 个 CAN
./startcan.sh

# 生成配置文件
./createconfigarmv7

# 调试页面（调试 up/down，合并并命名为 hlsup/hlsdown；选择 sn 乐器）
./blackarm_serverarmv7

# 演奏页面（验证发声）
./sksarm7       # 如无此程序，可尝试 ./sksarmv7

# 批量控制（多机）
python3 server.py
```

---


